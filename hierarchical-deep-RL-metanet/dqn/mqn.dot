digraph G {
labelloc="t";
label="mqn";
node [shape = oval]; 
n1[label="q (1)\nmodule = nn.Linear(267 -> 6)\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:48_"];
n2[label="Node2\ninput = {}\lreverseMap = {}" tooltip="[[C]]:-1_"];
n3[label="out (3)\nmodule = nn.JoinTable\lreverseMap = {}\lmapindex = {Node4,Node5}" tooltip="[./grgr_additions/model/mqn.lua]:47_"];
n4[label="Node4\nmodule = nn.View(-1)\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:46_"];
n5[label="subgoal_features (5)\nmodule = nn.ReLU\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:45_"];
n6[label="hid_out (6)\nmodule = nn.JoinTable\lreverseMap = {}\lmapindex = {Node8,Node9}" tooltip="[./grgr_additions/model/mqn.lua]:43_"];
n7[label="subgoal_linear2 (7)\nmodule = nn.Linear(50 -> 11)\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:56_"];
n8[label="Node8\nmodule = nn.Narrow\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:40_"];
n9[label="Node9\nmodule = nn.ReLU\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:42_"];
n10[label="subgoal_ReLu1 (10)\nmodule = nn.ReLU\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:55_"];
n11[label="D (11)\nmodule = nn.CAddTable\lreverseMap = {}\lmapindex = {Node14,Node15}" tooltip="[./grgr_additions/model/mqn.lua]:33_"];
n12[label="Node12\nmodule = nn.Narrow\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:41_"];
n13[label="subgoal_linear1 (13)\nmodule = nn.Linear(63 -> 50)\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:54_"];
n14[label="C (14)\nmodule = nn.LinearNB\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:32_"];
n15[label="o (15)\nmodule = nn.MM\lreverseMap = {}\lmapindex = {Node18,Node19}" tooltip="[./grgr_additions/model/mqn.lua]:75_"];
n16[label="input (16)\nmodule = nn.Identity\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:16_"];
n17[label="hid2dim (17)\nmodule = nn.View(-1)\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:31_"];
n18[label="probs3dim (18)\nmodule = nn.View(1, -1)\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:73_"];
n19[label="val_blocks_t (19)\nmodule = nn.Narrow\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:68_"];
n20[label="Node20\ninput = {{torch.CudaTensor[256x84672],torch.CudaTensor[256x63]}}\lselectindex = 2\lreverseMap = {}" tooltip="[[C]]:-1_-2"];
n21[label="context (21)\nmodule = nn.Linear(4096 -> 256)\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:65_"];
n22[label="P (22)\nmodule = nn.SoftMax\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:72_"];
n23[label="val_blocks (23)\nmodule = nn.View(-1, 11, 256)\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:28_"];
n24[label="Node24\ninput = {{torch.CudaTensor[256x84672],torch.CudaTensor[256x63]}}\lreverseMap = {}\lnSplitOutputs = 2" tooltip="[[C]]:-1_ split at [...2076831r/torch/install/share/lua/5.1/nngraph/gmodule.lua]:96-mnode"];
n25[label="context_flat (25)\nmodule = nn.View(-1)\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:86_"];
n26[label="key_out2dim (26)\nmodule = nn.View(-1)\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:71_"];
n27[label="Node27\nmodule = nn.Linear(4096 -> 256)\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:26_"];
n28[label="Node28\ninput = {torch.CudaTensor[256x84672],torch.CudaTensor[256x63]}\lreverseMap = {}" tooltip="[[C]]:-1_"];
n29[label="context (29)\nmodule = nn.Narrow\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:85_"];
n30[label="key_out (30)\nmodule = nn.MM\lreverseMap = {}\lmapindex = {Node33,Node34}" tooltip="[./grgr_additions/model/mqn.lua]:70_"];
n31[label="history_flat (31)\nmodule = nn.View(-1)\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:24_"];
n32[label="x (32)\nmodule = nn.View(-1, 12, 4096)\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:22_"];
n33[label="hid (33)\nmodule = nn.View(1, -1)\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:66_"];
n34[label="key_blocks_t (34)\nmodule = nn.Narrow\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:67_"];
n35[label="history (35)\nmodule = nn.Narrow\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:23_"];
n36[label="conv_flat (36)\nmodule = nn.View(-1)\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:105_"];
n37[label="key_blocks (37)\nmodule = nn.View(-1, 11, 256)\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:27_"];
n38[label="conv_nl3 (38)\nmodule = nn.ReLU\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:101_"];
n39[label="Node39\nmodule = nn.Linear(4096 -> 256)\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:25_"];
n40[label="conv3 (40)\nmodule = nn.SpatialConvolution(64 -> 64, 3x3)\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:100_"];
n41[label="conv_nl2 (41)\nmodule = nn.ReLU\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:101_"];
n42[label="conv2 (42)\nmodule = nn.SpatialConvolution(32 -> 64, 4x4, 2,2, 1,1)\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:100_"];
n43[label="conv_nl1 (43)\nmodule = nn.ReLU\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:101_"];
n44[label="conv1 (44)\nmodule = nn.SpatialConvolution(1 -> 32, 8x8, 4,4, 1,1)\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:100_"];
n45[label="reshape_input (45)\ninput = {torch.CudaTensor[256x84672]}\lmodule = nn.View(-1, 1, 84, 84)\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:92_"];
n46[label="input (46)\ninput = {torch.CudaTensor[256x84672]}\lmodule = nn.Identity\lreverseMap = {}" tooltip="[./grgr_additions/model/mqn.lua]:8_"];
n47[label="Node47\ninput = {{torch.CudaTensor[256x84672],torch.CudaTensor[256x63]}}\lselectindex = 1\lreverseMap = {}" tooltip="[[C]]:-1_-1"];
n1 -> n2;
n3 -> n1;
n4 -> n3;
n5 -> n3;
n6 -> n4;
n7 -> n5;
n8 -> n6;
n9 -> n6;
n10 -> n7;
n11 -> n8;
n12 -> n9;
n13 -> n10;
n14 -> n11;
n15 -> n11;
n11 -> n12;
n16 -> n13;
n17 -> n14;
n18 -> n15;
n19 -> n15;
n20 -> n16;
n21 -> n17;
n22 -> n18;
n23 -> n19;
n24 -> n20;
n25 -> n21;
n26 -> n22;
n27 -> n23;
n28 -> n24;
n29 -> n25;
n30 -> n26;
n31 -> n27;
n32 -> n29;
n33 -> n30;
n34 -> n30;
n35 -> n31;
n36 -> n32;
n21 -> n33;
n37 -> n34;
n32 -> n35;
n38 -> n36;
n39 -> n37;
n40 -> n38;
n31 -> n39;
n41 -> n40;
n42 -> n41;
n43 -> n42;
n44 -> n43;
n45 -> n44;
n46 -> n45;
n47 -> n46;
n24 -> n47;
n45[style=filled, fillcolor=red];
}